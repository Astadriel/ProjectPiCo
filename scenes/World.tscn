[gd_scene load_steps=8 format=2]

[ext_resource path="res://instances/Tower.tscn" type="PackedScene" id=1]
[ext_resource path="res://instances/Base.tscn" type="PackedScene" id=2]
[ext_resource path="res://sprites/village.png" type="Texture" id=3]
[ext_resource path="res://instances/Slot.tscn" type="PackedScene" id=4]

[sub_resource type="GDScript" id=1]

script/source = "extends Node

const ENEMY_PATH = \"res://instances/Enemy.tscn\"
const VICTORY_PATH = \"res://instances/Victory.tscn\"
var spawn_delay = 1
var spawn_count = spawn_delay
var victory = false
var wave_max = 2
var wave_current = 0
var enemy_spawned = 0
var enemy_max = 0
var enemy_dead = 0
var wave_initialize = true
var enemy_color = \"blue\"
var ressource = 100


func _ready():

	pass

func _process(delta):
	#counter updates
	spawn_count -= delta
	#update labels
	get_node(\"Label_Wave\").text = str(\"WAVE: \", wave_current, \"/\", wave_max)
	get_node(\"Label_Ressource\").text = str(\"RESSOURCE: \", ressource)
	#check if end of current wave
	if enemy_dead == enemy_max:
		if wave_current < wave_max:
			wave_current += 1
			wave_initialize = true
	
	#wave initialization
	if wave_initialize == true:
		wave_initialize = false
		enemy_dead = 0
		enemy_spawned = 0
		
		if wave_current == 1:
			enemy_max = 2
			enemy_color = \"blue\"
		elif wave_current == 2:
			enemy_max = 5
			enemy_color = \"red\"
		elif wave_current == 3:
			enemy_max = 5
			enemy_color = \"mixed\"
		elif wave_current == 4:
			enemy_max = 15
			enemy_color = \"blue\"
		elif wave_current == 5:
			enemy_max = 30
			enemy_color = \"red\"
		elif wave_current == 6:
			enemy_max = 40
		elif wave_current == 7:
			enemy_max = 60
		elif wave_current == 8:
			enemy_max = 80
		elif wave_current == 9:
			enemy_max = 100
		else:
			wave_current = wave_max
			enemy_dead = enemy_max
			
		print(\"current wave:\")
		print(wave_current)
	
	#enemy spawning
	if spawn_count < 0: #spawn an enemy
		spawn_count = spawn_delay
		if enemy_spawned < enemy_max:
			var enemy_preload = preload(ENEMY_PATH)
			var enemy_instance = enemy_preload.instance()
			get_node(\"Path_Enemy\").add_child(enemy_instance)
			#set the enemy color
			if enemy_color == \"mixed\":
				var i = randi()%2
				print(i)
				if i == 0:
					enemy_instance.color = \"blue\"
					print(\"blue\")
				else:
					enemy_instance.color = \"red\"
					print(\"red\")
			else:
				enemy_instance.color = enemy_color
			enemy_spawned += 1

	#check for victory
	if get_node(\"Base\").game_over == false:
		#check if victory
		if wave_current == wave_max:
			if enemy_dead == enemy_max:
				if victory == false:
					var victory_preload = preload(VICTORY_PATH)
					var victory_instance = victory_preload.instance()
					get_tree().get_root().get_node(\"World\").add_child(victory_instance)
					victory = true
					print(\"VICTORY\")

"

[sub_resource type="StreamTexture" id=2]

flags = 0
load_path = "res://.import/level1_bkgd.png-9b338efb9793ca0901763cbe6296c1a6.stex"

[sub_resource type="Curve2D" id=3]

bake_interval = 5.0
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, -126.185, 236.534, 0, 0, 23.9163, 2.25625, -26.7386, 238.375, 0, 0, -13.5375, -29.7825, -5.25318, 218.731, 0, 0, 10.3788, -33.3925, -3.41157, 169.008, 0, 0, -18.9525, -44.2225, -4.63932, 115.601, 0, 0, 32.9413, -10.3788, 19.9155, 60.3532, 0, 0, 33.3925, 4.5125, 80.0746, 54.8284, 0, 0, -4.06125, 32.49, 109.54, 84.2941, 0, 0, -53.6988, -12.1838, 77.6192, 117.443, 0, 0, 0, 0, 32.8067, 163.483, 0, 0, 7.22001, 42.8688, 37.1038, 207.068, 0, 0, 35.1975, 7.22001, 70.2527, 244.514, 0, 0, 0, 0, 102.788, 221.187, 0, 0, -10.83, -35.1975, 96.0352, 188.652, 0, 0, 0, 0, 115.065, 146.295, 0, 0, 23.9163, -4.96375, 137.164, 140.156, 0, 0, -9.02501, -58.2113, 154.353, 114.988, 0, 0, 79.4201, 4.5125, 203.462, 61.5809, 0, 0, -35.1975, -1.805, 231.38, 111.41, 0, 0, 4.06125, 59.1138, 202.848, 137.087, 0, 0, -30.2338, -1.805, 163.561, 186.196, 0, 0, -2.25625, 28.4288, 134.709, 219.959, 0, 0, 0, 0, 166.016, 243.9, 0, 0, 42.4175, -1.35375, 261.166, 242.058, 0, 0, -2.7075, -26.6238, 292.473, 210.751, 0, 0, -18.05, -1.805, 262.394, 184.969, 0, 0, -7.22001, -38.3563, 244.592, 163.483, 0, 0, 0, 0, 273.443, 123.582, 0, 0, 0, 0, 331.147, 125.423 )
}
_sections_unfolded = [ "Resource" ]

[node name="World" type="Node2D" index="0"]

scale = Vector2( 2, 2 )
script = SubResource( 1 )
_sections_unfolded = [ "Transform" ]

[node name="Sprite" type="Sprite" parent="." index="0"]

position = Vector2( 256, 150 )
texture = SubResource( 2 )
_sections_unfolded = [ "Transform" ]

[node name="Tower" parent="." index="1" instance=ExtResource( 1 )]

position = Vector2( 315.569, 80.7669 )
_sections_unfolded = [ "Transform" ]

[node name="Base" parent="." index="2" instance=ExtResource( 2 )]

position = Vector2( 432.378, 123.611 )

[node name="Sprite" type="Sprite" parent="Base" index="1"]

texture = ExtResource( 3 )

[node name="Path_Enemy" type="Path2D" parent="." index="3"]

position = Vector2( 98.4207, -0.108512 )
curve = SubResource( 3 )
_sections_unfolded = [ "Transform" ]

[node name="Label_Wave" type="Label" parent="." index="4"]

anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
margin_right = 40.0
margin_bottom = 14.0
rect_pivot_offset = Vector2( 0, 0 )
rect_clip_content = false
mouse_filter = 2
mouse_default_cursor_shape = 0
size_flags_horizontal = 1
size_flags_vertical = 4
text = "WAVE: 0/0"
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1

[node name="Label_Ressource" type="Label" parent="." index="5"]

anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
margin_left = 79.0
margin_right = 161.0
margin_bottom = 14.0
rect_pivot_offset = Vector2( 0, 0 )
rect_clip_content = false
mouse_filter = 2
mouse_default_cursor_shape = 0
size_flags_horizontal = 1
size_flags_vertical = 4
text = "Ressource: 0"
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1

[node name="Slot3" parent="." index="6" instance=ExtResource( 4 )]

position = Vector2( 176, 85.5001 )

[node name="Slot2" parent="." index="7" instance=ExtResource( 4 )]

position = Vector2( 119.5, 87.0001 )

[node name="Slot4" parent="." index="8" instance=ExtResource( 4 )]

position = Vector2( 172.5, 216 )

[node name="Slot6" parent="." index="9" instance=ExtResource( 4 )]

position = Vector2( 224.5, 122 )

[node name="Slot5" parent="." index="10" instance=ExtResource( 4 )]

position = Vector2( 168.5, 145 )

[node name="Slot7" parent="." index="11" instance=ExtResource( 4 )]

position = Vector2( 280.5, 95.0001 )

[node name="Slot8" parent="." index="12" instance=ExtResource( 4 )]

position = Vector2( 270.5, 156 )

[node name="Slot9" parent="." index="13" instance=ExtResource( 4 )]

position = Vector2( 262.5, 216 )

[node name="Slot10" parent="." index="14" instance=ExtResource( 4 )]

position = Vector2( 365.001, 215 )

[node name="Slot11" parent="." index="15" instance=ExtResource( 4 )]

position = Vector2( 370.001, 153.5 )

[node name="Slot12" parent="." index="16" instance=ExtResource( 4 )]

position = Vector2( 222, 176 )

[node name="Slot13" parent="." index="17" instance=ExtResource( 4 )]

position = Vector2( 168, 180.5 )

[node name="Slot14" parent="." index="18" instance=ExtResource( 4 )]

position = Vector2( 71.0003, 145.5 )

[node name="Slot15" parent="." index="19" instance=ExtResource( 4 )]

position = Vector2( 366.501, 101 )

[node name="Slot16" parent="." index="20" instance=ExtResource( 4 )]

position = Vector2( 312.501, 214.5 )

[node name="Slot17" parent="." index="21" instance=ExtResource( 4 )]

position = Vector2( 112.5, 185.5 )

[node name="Slot18" parent="." index="22" instance=ExtResource( 4 )]

position = Vector2( 115.5, 242 )

[node name="Slot19" parent="." index="23" instance=ExtResource( 4 )]

position = Vector2( 218.5, 256.5 )

[node name="Slot20" parent="." index="24" instance=ExtResource( 4 )]

position = Vector2( 231.5, 65.5001 )

[node name="Slot21" parent="." index="25" instance=ExtResource( 4 )]

position = Vector2( 325.501, 136 )

[node name="Slot22" parent="." index="26" instance=ExtResource( 4 )]

position = Vector2( 321.001, 181 )

[node name="Slot23" parent="." index="27" instance=ExtResource( 4 )]

position = Vector2( 68.0003, 62.0001 )

[node name="Slot24" parent="." index="28" instance=ExtResource( 4 )]

position = Vector2( 407.001, 249.5 )

[node name="Slot25" parent="." index="29" instance=ExtResource( 4 )]

position = Vector2( 337.001, 43.0001 )

[node name="Slot" parent="." index="30" instance=ExtResource( 4 )]

position = Vector2( 64.0003, 212 )

[node name="Slot26" parent="." index="31" instance=ExtResource( 4 )]

position = Vector2( 312.001, 267 )

[node name="Slot27" parent="." index="32" instance=ExtResource( 4 )]

position = Vector2( 147.5, 34.5001 )


