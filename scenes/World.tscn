[gd_scene load_steps=7 format=2]

[ext_resource path="res://instances/Tower.tscn" type="PackedScene" id=1]
[ext_resource path="res://instances/Base.tscn" type="PackedScene" id=2]
[ext_resource path="res://sprites/village.png" type="Texture" id=3]

[sub_resource type="GDScript" id=1]

script/source = "extends Node

# class member variables go here, for example:
# var a = 2
const ENEMY_PATH = \"res://instances/Enemy.tscn\"
const VICTORY_PATH = \"res://instances/Victory.tscn\"
var spawn_delay = 1
var spawn_count = spawn_delay
var victory = false
var wave_max = 2
var wave_current = 0
var enemy_spawned = 0
var enemy_max = 0
var enemy_dead = 0
var wave_initialize = true



func _ready():

	# Called every time the node is added to the scene.
	# Initialization here
	pass

func _process(delta):
	spawn_count -= delta
	if enemy_dead == enemy_max:
		if wave_current < wave_max:
			wave_current += 1
			wave_initialize = true
	
	if wave_initialize == true:
		wave_initialize = false
		wave_current += 1
		enemy_dead = 0
		
		if wave_current == 1:
			enemy_max = 2
		elif wave_current == 2:
			enemy_max = 2
		elif wave_current == 3:
			enemy_max = 2
		elif wave_current == 4:
			enemy_max = 2
		elif wave_current == 5:
			enemy_max = 2
		else:
			wave_current = wave_max
			enemy_dead = enemy_max
		
		
		
	
	if spawn_count < 0: #spawn an enemy
		spawn_count = spawn_delay
		if enemy_spawned < enemy_max:
			var enemy_preload = preload(ENEMY_PATH)
			var enemy_instance = enemy_preload.instance()
			get_node(\"Path_Enemy\").add_child(enemy_instance)
			enemy_spawned += 1

	
	if get_node(\"Base\").game_over == false:
		#check if victory
		if wave_current == wave_max:
			if enemy_dead == enemy_max:
				if victory == false:
					var victory_preload = preload(VICTORY_PATH)
					var victory_instance = victory_preload.instance()
					get_tree().get_root().get_node(\"World\").add_child(victory_instance)
					victory = true
				
		
	
"

[sub_resource type="StreamTexture" id=2]

flags = 0
load_path = "res://.import/level1_bkgd.png-9b338efb9793ca0901763cbe6296c1a6.stex"

[sub_resource type="Curve2D" id=3]

bake_interval = 5.0
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, -253.972, 388.282, 0, 0, 17.7547, -34.1662, -17.9395, 390.782, 0, 0, 16.7103, -37.4995, -26.2946, 310.783, 0, 0, -8.35513, -45.8327, 7.12593, 248.284, 0, 0, 2.74142, -58.6143, -18.9839, 146.618, 0, 0, 90.8744, -6.31132, 115.743, 91.6193, 0, 0, 7.39482, 56.7033, 229.581, 119.952, 0, 0, -91.709, -9.46712, 183.628, 194.951, 0, 0, -32.2445, 42.6256, 81.2777, 200.784, 0, 0, 26.9182, 38.2113, 87.5441, 381.615, 0, 0, 22.1093, -18.5017, 198.25, 404.115, 0, 0, 15.6659, -38.5048, 194.072, 275.776, 0, 0, 19.8434, -5.85943, 313.133, 226.617, 0, 0, 45.6654, -49.3888, 322.532, 134.952, 0, 0, 81.6365, -0.948483, 433.238, 95.7859, 0, 0, -32.4156, 47.6039, 519.922, 145.785, 0, 0, -12.6441, -4.57078, 431.149, 186.618, 0, 0, -56.5479, 25.0019, 406.083, 289.116, 0, 0, -30.6935, 57.7037, 299.556, 315.783, 0, 0, 46.654, 28.238, 282.845, 390.782, 0, 0, 24.8726, -4.35244, 580.497, 398.282, 0, 0, 1.83348, -38.0605, 609.74, 353.282, 0, 0, -77.3475, 14.7329, 578.408, 304.95, 0, 0, -4.91095, -57.7037, 503.212, 282.45, 0, 0, 0, 0, 520.967, 213.284, 0, 0, 0, 0, 610.784, 205.784, 0, 0, 0, 0, 721.49, 204.118 )
}
_sections_unfolded = [ "Resource" ]

[node name="World" type="Node2D" index="0"]

scale = Vector2( 2, 2 )
script = SubResource( 1 )
_sections_unfolded = [ "Transform" ]

[node name="Sprite" type="Sprite" parent="." index="0"]

position = Vector2( 256, 150 )
texture = SubResource( 2 )
_sections_unfolded = [ "Transform" ]

[node name="Tower" parent="Sprite" index="0" instance=ExtResource( 1 )]

position = Vector2( 75.0689, -73.7331 )
_sections_unfolded = [ "Transform" ]

[node name="Path_Enemy" type="Path2D" parent="." index="1"]

position = Vector2( 98.5886, 2.27174 )
scale = Vector2( 0.478748, 0.597328 )
curve = SubResource( 3 )

[node name="Base" parent="." index="2" instance=ExtResource( 2 )]

position = Vector2( 432.378, 123.611 )

[node name="Sprite" type="Sprite" parent="Base" index="1"]

texture = ExtResource( 3 )


