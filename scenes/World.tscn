[gd_scene load_steps=8 format=2]

[ext_resource path="res://instances/Tower.tscn" type="PackedScene" id=1]
[ext_resource path="res://instances/Base.tscn" type="PackedScene" id=2]
[ext_resource path="res://sprites/village.png" type="Texture" id=3]
[ext_resource path="res://instances/Slot.tscn" type="PackedScene" id=4]

[sub_resource type="GDScript" id=1]

script/source = "extends Node

const ENEMY_PATH = \"res://instances/Enemy.tscn\"
const VICTORY_PATH = \"res://instances/Victory.tscn\"
var spawn_delay = 1
var spawn_count = spawn_delay
var victory = false
var wave_max = 10
var wave_current = 0
var enemy_spawned = 0
var enemy_max = 0
var enemy_dead = 0
var wave_initialize = true


#func _ready():
#	pass

func _process(delta):
	#counter updates
	spawn_count -= delta
	#check if end of current wave
	if enemy_dead == enemy_max:
		if wave_current < wave_max:
			wave_current += 1
			wave_initialize = true
	
	#wave initialization
	if wave_initialize == true:
		wave_initialize = false
		enemy_dead = 0
		enemy_spawned = 0
		
		if wave_current == 1:
			enemy_max = 2
		elif wave_current == 2:
			enemy_max = 5
		elif wave_current == 3:
			enemy_max = 10
		elif wave_current == 4:
			enemy_max = 20
		elif wave_current == 5:
			enemy_max = 30
		elif wave_current == 6:
			enemy_max = 40
		elif wave_current == 7:
			enemy_max = 60
		elif wave_current == 8:
			enemy_max = 80
		elif wave_current == 9:
			enemy_max = 100
		else:
			wave_current = wave_max
			enemy_dead = enemy_max
			
		print(\"current wave:\")
		print(wave_current)
	
	#enemy spawning
	if spawn_count < 0: #spawn an enemy
		spawn_count = spawn_delay
		if enemy_spawned < enemy_max:
			var enemy_preload = preload(ENEMY_PATH)
			var enemy_instance = enemy_preload.instance()
			get_node(\"Path_Enemy\").add_child(enemy_instance)
			enemy_spawned += 1

	#check for victory
	if get_node(\"Base\").game_over == false:
		#check if victory
		if wave_current == wave_max:
			if enemy_dead == enemy_max:
				if victory == false:
					var victory_preload = preload(VICTORY_PATH)
					var victory_instance = victory_preload.instance()
					get_tree().get_root().get_node(\"World\").add_child(victory_instance)
					victory = true
					print(\"VICTORY\")

"

[sub_resource type="StreamTexture" id=2]

flags = 0
load_path = "res://.import/level1_bkgd.png-9b338efb9793ca0901763cbe6296c1a6.stex"

[sub_resource type="Curve2D" id=3]

bake_interval = 5.0
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, -126.185, 236.534, 0, 0, 23.9163, 2.25625, -26.7386, 238.375, 0, 0, -13.5375, -29.7825, -5.25318, 218.731, 0, 0, 10.3788, -33.3925, -3.41157, 169.008, 0, 0, -18.9525, -44.2225, -4.63932, 115.601, 0, 0, 32.9413, -10.3788, 19.9155, 60.3532, 0, 0, 33.3925, 4.5125, 80.0746, 54.8284, 0, 0, -4.06125, 32.49, 109.54, 84.2941, 0, 0, -53.6988, -12.1838, 77.6192, 117.443, 0, 0, 0, 0, 32.8067, 163.483, 0, 0, 7.22001, 42.8688, 37.1038, 207.068, 0, 0, 35.1975, 7.22001, 70.2527, 244.514, 0, 0, 0, 0, 102.788, 221.187, 0, 0, -10.83, -35.1975, 96.0352, 188.652, 0, 0, 0, 0, 115.065, 146.295, 0, 0, 23.9163, -4.96375, 137.164, 140.156, 0, 0, -9.02501, -58.2113, 154.353, 114.988, 0, 0, 79.4201, 4.5125, 203.462, 61.5809, 0, 0, -35.1975, -1.805, 231.38, 111.41, 0, 0, 4.06125, 59.1138, 202.848, 137.087, 0, 0, -30.2338, -1.805, 163.561, 186.196, 0, 0, -2.25625, 28.4288, 134.709, 219.959, 0, 0, 0, 0, 166.016, 243.9, 0, 0, 42.4175, -1.35375, 261.166, 242.058, 0, 0, -2.7075, -26.6238, 292.473, 210.751, 0, 0, -18.05, -1.805, 262.394, 184.969, 0, 0, -7.22001, -38.3563, 244.592, 163.483, 0, 0, 0, 0, 273.443, 123.582, 0, 0, 0, 0, 331.147, 125.423 )
}
_sections_unfolded = [ "Resource" ]

[node name="World" type="Node2D" index="0"]

scale = Vector2( 2, 2 )
script = SubResource( 1 )
_sections_unfolded = [ "Transform" ]

[node name="Sprite" type="Sprite" parent="." index="0"]

position = Vector2( 256, 150 )
texture = SubResource( 2 )
_sections_unfolded = [ "Transform" ]

[node name="Tower" parent="Sprite" index="0" instance=ExtResource( 1 )]

position = Vector2( 59.5689, -69.2331 )
_sections_unfolded = [ "Transform" ]

[node name="Base" parent="." index="1" instance=ExtResource( 2 )]

position = Vector2( 432.378, 123.611 )

[node name="Sprite" type="Sprite" parent="Base" index="1"]

texture = ExtResource( 3 )

<<<<<<< HEAD
[node name="Slot" parent="." index="3" instance=ExtResource( 4 )]

position = Vector2( 38, 38.5 )
=======
[node name="Path_Enemy" type="Path2D" parent="." index="2"]

position = Vector2( 98.4207, -0.108512 )
curve = SubResource( 3 )
_sections_unfolded = [ "Transform" ]
>>>>>>> 90f0b2176d89fc9b042ec723cc4bfacc8a3a34a5


