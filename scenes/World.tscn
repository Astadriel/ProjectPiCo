[gd_scene load_steps=8 format=2]

[ext_resource path="res://instances/Tower.tscn" type="PackedScene" id=1]
[ext_resource path="res://instances/Base.tscn" type="PackedScene" id=2]
[ext_resource path="res://sprites/village.png" type="Texture" id=3]
[ext_resource path="res://instances/Slot.tscn" type="PackedScene" id=4]

[sub_resource type="GDScript" id=1]

script/source = "extends Node

const ENEMY_PATH = \"res://instances/Enemy.tscn\"
const VICTORY_PATH = \"res://instances/Victory.tscn\"
var spawn_delay = 1
var spawn_count = spawn_delay
var victory = false
var wave_max = 2
var wave_current = 0
var enemy_spawned = 0
var enemy_max = 0
var enemy_dead = 0
var wave_initialize = true
var enemy_color = \"blue\"
var ressource = 100


func _ready():

	pass

func _process(delta):
	#counter updates
	spawn_count -= delta
	#update labels
	get_node(\"Label_Wave\").text = str(\"WAVE: \", wave_current, \"/\", wave_max)
	get_node(\"Label_Ressource\").text = str(\"RESSOURCE: \", ressource)
	#check if end of current wave
	if enemy_dead == enemy_max:
		if wave_current < wave_max:
			wave_current += 1
			wave_initialize = true
	
	#wave initialization
	if wave_initialize == true:
		wave_initialize = false
		enemy_dead = 0
		enemy_spawned = 0
		
		if wave_current == 1:
			enemy_max = 2
			enemy_color = \"blue\"
		elif wave_current == 2:
			enemy_max = 5
			enemy_color = \"red\"
		elif wave_current == 3:
			enemy_max = 5
			enemy_color = \"mixed\"
		elif wave_current == 4:
			enemy_max = 15
			enemy_color = \"blue\"
		elif wave_current == 5:
			enemy_max = 30
			enemy_color = \"red\"
		elif wave_current == 6:
			enemy_max = 40
		elif wave_current == 7:
			enemy_max = 60
		elif wave_current == 8:
			enemy_max = 80
		elif wave_current == 9:
			enemy_max = 100
		else:
			wave_current = wave_max
			enemy_dead = enemy_max
			
		print(\"current wave:\")
		print(wave_current)
	
	#enemy spawning
	if spawn_count < 0: #spawn an enemy
		spawn_count = spawn_delay
		if enemy_spawned < enemy_max:
			var enemy_preload = preload(ENEMY_PATH)
			var enemy_instance = enemy_preload.instance()
			get_node(\"Path_Enemy\").add_child(enemy_instance)
			#set the enemy color
			if enemy_color == \"mixed\":
				var i = randi()%2
				print(i)
				if i == 0:
					enemy_instance.color = \"blue\"
					print(\"blue\")
				else:
					enemy_instance.color = \"red\"
					print(\"red\")
			else:
				enemy_instance.color = enemy_color
			enemy_spawned += 1

	#check for victory
	if get_node(\"Base\").game_over == false:
		#check if victory
		if wave_current == wave_max:
			if enemy_dead == enemy_max:
				if victory == false:
					var victory_preload = preload(VICTORY_PATH)
					var victory_instance = victory_preload.instance()
					get_tree().get_root().get_node(\"World\").add_child(victory_instance)
					victory = true
					print(\"VICTORY\")

"

[sub_resource type="StreamTexture" id=2]

flags = 0
load_path = "res://.import/level1_bkgd.png-9b338efb9793ca0901763cbe6296c1a6.stex"

[sub_resource type="Curve2D" id=3]

bake_interval = 5.0
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, -127.367, 239.55, 0, 0, 23.1058, -0.17537, -28.8113, 239.957, 1.89126, 5.94396, -12.0673, -33.8255, -5.25318, 218.731, -2.97198, 9.4563, 4.09891, -12.6519, -2.5701, 163.876, 0, 0, -17.8718, -43.9523, -1.36794, 117.621, -6.80262, 3.57387, 31.3202, -5.78574, 23.5994, 60.9673, -19.3058, -0.441359, 30.8788, 1.48301, 82.6438, 58.977, 0, 0, -0.81909, 21.6828, 109.54, 84.2941, 9.99666, 0.54036, -53.5723, -4.77935, 77.9768, 120.551, -0.367546, -10.6588, 0.189536, 10.892, 36.3267, 167.663, -1.02719, -26.7651, -0.27009, 44.4311, 39.9755, 206.142, -7.56504, -0.81054, 19.2569, -0.615212, 84.148, 245.869, 0, 0, 0, 0, 100.899, 224.255, 0, 0, -2.45442, -36.008, 96.0359, 182.106, -5.13342, 2.7018, 10.537, -2.7018, 124.451, 148.158, 7.56504, 29.7198, -7.69477, -40.0872, 152.774, 111.319, -3.51234, 0.81054, 47.9195, -4.83988, 189.395, 63.9483, -0.484899, -8.71733, 1.17396, 10.5555, 245.204, 84.8021, 10.7457, -0.00276333, -24.6605, -1.53482, 224.35, 113.799, 0, 0, 8.92449, 52.0891, 203.847, 137.128, 0, 0, -33.2058, 0.712447, 165.364, 190.461, 0, 0, -0.63517, 29.2393, 134.709, 219.959, 0, 0, 0, 0, 166.016, 243.9, 0, 0, 42.4175, -1.35375, 261.166, 242.058, 0, 0, -5.4093, -21.7606, 290.575, 206.834, 20.5337, -0.54036, -18.05, -1.805, 261.49, 186.688, 0, 0, -2.35677, -40.2476, 244.592, 163.483, 0, 0, 0, 0, 273.803, 127.9, 0, 0, 0, 0, 330.605, 129.29 )
}
_sections_unfolded = [ "Resource" ]

[node name="World" type="Node2D" index="0"]

scale = Vector2( 2, 2 )
script = SubResource( 1 )
_sections_unfolded = [ "Transform" ]

[node name="Sprite" type="Sprite" parent="." index="0"]

position = Vector2( 256, 150 )
texture = SubResource( 2 )
_sections_unfolded = [ "Transform" ]

[node name="Tower" parent="." index="1" instance=ExtResource( 1 )]

position = Vector2( 315.569, 80.7669 )
_sections_unfolded = [ "Transform" ]

[node name="Base" parent="." index="2" instance=ExtResource( 2 )]

position = Vector2( 432.378, 123.611 )
_sections_unfolded = [ "Transform" ]

[node name="Sprite" type="Sprite" parent="Base" index="1"]

texture = ExtResource( 3 )
_sections_unfolded = [ "Transform" ]

[node name="Path_Enemy" type="Path2D" parent="." index="3"]

position = Vector2( 98.4207, -0.108512 )
curve = SubResource( 3 )
_sections_unfolded = [ "Transform" ]

[node name="Label_Wave" type="Label" parent="." index="4"]

anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
margin_right = 40.0
margin_bottom = 14.0
rect_pivot_offset = Vector2( 0, 0 )
rect_clip_content = false
mouse_filter = 2
mouse_default_cursor_shape = 0
size_flags_horizontal = 1
size_flags_vertical = 4
text = "WAVE: 0/0"
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1

[node name="Label_Ressource" type="Label" parent="." index="5"]

anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
margin_left = 79.0
margin_right = 161.0
margin_bottom = 14.0
rect_pivot_offset = Vector2( 0, 0 )
rect_clip_content = false
mouse_filter = 2
mouse_default_cursor_shape = 0
size_flags_horizontal = 1
size_flags_vertical = 4
text = "Ressource: 0"
percent_visible = 1.0
lines_skipped = 0
max_lines_visible = -1

[node name="TowerSlots" type="Node2D" parent="." index="6"]

scale = Vector2( 0.5, 0.5 )
_sections_unfolded = [ "Transform" ]

[node name="Slot22" parent="TowerSlots" index="0" instance=ExtResource( 4 )]

position = Vector2( 642.002, 362 )
scale = Vector2( 2, 2 )

[node name="Slot23" parent="TowerSlots" index="1" instance=ExtResource( 4 )]

position = Vector2( 136.001, 124 )
scale = Vector2( 2, 2 )

[node name="Slot24" parent="TowerSlots" index="2" instance=ExtResource( 4 )]

position = Vector2( 814.002, 499 )
scale = Vector2( 2, 2 )

[node name="Slot25" parent="TowerSlots" index="3" instance=ExtResource( 4 )]

position = Vector2( 674.002, 86.0002 )
scale = Vector2( 2, 2 )

[node name="Slot" parent="TowerSlots" index="4" instance=ExtResource( 4 )]

position = Vector2( 128.001, 424 )
scale = Vector2( 2, 2 )

[node name="Slot26" parent="TowerSlots" index="5" instance=ExtResource( 4 )]

position = Vector2( 624.002, 534 )
scale = Vector2( 2, 2 )

[node name="Slot27" parent="TowerSlots" index="6" instance=ExtResource( 4 )]

position = Vector2( 295, 69.0002 )
scale = Vector2( 2, 2 )

[node name="Slot2" parent="TowerSlots" index="7" instance=ExtResource( 4 )]

position = Vector2( 239, 174 )
scale = Vector2( 2, 2 )

[node name="Slot4" parent="TowerSlots" index="8" instance=ExtResource( 4 )]

position = Vector2( 345, 432 )
scale = Vector2( 2, 2 )

[node name="Slot6" parent="TowerSlots" index="9" instance=ExtResource( 4 )]

position = Vector2( 449, 244 )
scale = Vector2( 2, 2 )

[node name="Slot5" parent="TowerSlots" index="10" instance=ExtResource( 4 )]

position = Vector2( 337, 290 )
scale = Vector2( 2, 2 )

[node name="Slot7" parent="TowerSlots" index="11" instance=ExtResource( 4 )]

position = Vector2( 561, 190 )
scale = Vector2( 2, 2 )

[node name="Slot8" parent="TowerSlots" index="12" instance=ExtResource( 4 )]

position = Vector2( 541, 312 )
scale = Vector2( 2, 2 )

[node name="Slot9" parent="TowerSlots" index="13" instance=ExtResource( 4 )]

position = Vector2( 525, 432 )
scale = Vector2( 2, 2 )

[node name="Slot10" parent="TowerSlots" index="14" instance=ExtResource( 4 )]

position = Vector2( 730.002, 430 )
scale = Vector2( 2, 2 )

[node name="Slot11" parent="TowerSlots" index="15" instance=ExtResource( 4 )]

position = Vector2( 740.002, 307 )
scale = Vector2( 2, 2 )

[node name="Slot12" parent="TowerSlots" index="16" instance=ExtResource( 4 )]

position = Vector2( 444, 352 )
scale = Vector2( 2, 2 )

[node name="Slot13" parent="TowerSlots" index="17" instance=ExtResource( 4 )]

position = Vector2( 336, 361 )
scale = Vector2( 2, 2 )

[node name="Slot14" parent="TowerSlots" index="18" instance=ExtResource( 4 )]

position = Vector2( 142.001, 291 )
scale = Vector2( 2, 2 )

[node name="Slot15" parent="TowerSlots" index="19" instance=ExtResource( 4 )]

position = Vector2( 733.002, 202 )
scale = Vector2( 2, 2 )

[node name="Slot16" parent="TowerSlots" index="20" instance=ExtResource( 4 )]

position = Vector2( 625.002, 429 )
scale = Vector2( 2, 2 )

[node name="Slot17" parent="TowerSlots" index="21" instance=ExtResource( 4 )]

position = Vector2( 225, 371 )
scale = Vector2( 2, 2 )

[node name="Slot18" parent="TowerSlots" index="22" instance=ExtResource( 4 )]

position = Vector2( 231, 484 )
scale = Vector2( 2, 2 )

[node name="Slot19" parent="TowerSlots" index="23" instance=ExtResource( 4 )]

position = Vector2( 437, 513 )
scale = Vector2( 2, 2 )

[node name="Slot20" parent="TowerSlots" index="24" instance=ExtResource( 4 )]

position = Vector2( 463, 131 )
scale = Vector2( 2, 2 )

[node name="Slot21" parent="TowerSlots" index="25" instance=ExtResource( 4 )]

position = Vector2( 651.002, 272 )
scale = Vector2( 2, 2 )

[node name="Slot3" parent="TowerSlots" index="26" instance=ExtResource( 4 )]

position = Vector2( 352, 171 )
scale = Vector2( 2, 2 )


